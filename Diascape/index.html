<html>

<head>
  <meta charset=UTF-8 />
  <link rel="stylesheet" type="text/css" href="style.css" />

</head>

<body>
  <script src="js/three.min.js"></script>
  <script src="js/orbitControls.js"></script>
  <script src="js/gltfLoader.js"></script>

  <script>
    let scene, camera, renderer, meshBox1, meshBox2, meshBox3, meshBox4, meshBox5, model, intersects;
    let solutionObject1,solutionObject2,solutionObject3;
    let count = 0 ;
    function init() {

      scene = new THREE.Scene();
      camera = new THREE.PerspectiveCamera(55, window.innerWidth / window.innerHeight, 45, 30000);
      camera.position.set(-900, -200, -900);

      renderer = new THREE.WebGLRenderer({ antialias: true });
      renderer.setSize(window.innerWidth, window.innerHeight);
      document.body.appendChild(renderer.domElement);

      let controls = new THREE.OrbitControls(camera, renderer.domElement);
      controls.minDistance = 500;
      controls.maxDistance = 1500;

      let materialArray = [];
      let texture_ft = new THREE.TextureLoader().load('arid2_ft2.jpg');
      let texture_bk = new THREE.TextureLoader().load('arid2_bk2.jpg');
      let texture_up = new THREE.TextureLoader().load('arid2_up2.jpg');
      let texture_dn = new THREE.TextureLoader().load('arid2_dn2.jpg');
      let texture_rt = new THREE.TextureLoader().load('arid2_rt2.jpg');
      let texture_lf = new THREE.TextureLoader().load('arid2_lf2.jpg');

      materialArray.push(new THREE.MeshStandardMaterial({ map: texture_ft }));
      materialArray.push(new THREE.MeshStandardMaterial({ map: texture_bk }));
      materialArray.push(new THREE.MeshStandardMaterial({ map: texture_up }));
      materialArray.push(new THREE.MeshStandardMaterial({ map: texture_dn }));
      materialArray.push(new THREE.MeshStandardMaterial({ map: texture_rt }));
      materialArray.push(new THREE.MeshStandardMaterial({ map: texture_lf }));

      for (let i = 0; i < 6; i++)
        materialArray[i].side = THREE.BackSide;
      let skyboxGeo = new THREE.BoxGeometry(25000, 12000, 17000);
      let skybox = new THREE.Mesh(skyboxGeo, materialArray);
      scene.add(skybox);

// geometery- meshbox 
      meshBox1 = new THREE.Mesh(new THREE.BoxBufferGeometry(50, 50, 300), new THREE.MeshBasicMaterial({ color: 'green', transparent: true, opacity: 1.0 }));
      meshBox1.position.set(12400, -1300, 700);
      meshBox1.name = 'switch1';
      scene.add(meshBox1);

      meshBox5 = new THREE.Mesh(new THREE.BoxBufferGeometry(50, 50, 300), new THREE.MeshBasicMaterial({ color: 'red', transparent: true, opacity: 1.0 }));
      meshBox5.position.set(12400, -1300, 200);
      meshBox5.name = 'switch2';
      scene.add(meshBox5);


      meshBox2 = new THREE.Mesh(new THREE.BoxBufferGeometry(50, 700, 700), new THREE.MeshStandardMaterial({ transparent: true, opacity: 0.0 }));
      meshBox2.position.set(12400, 1550, -850);
      meshBox2.name = 'watch';
      scene.add(meshBox2);

      meshBox3 = new THREE.Mesh(new THREE.BoxBufferGeometry(1900, -1100, 50), new THREE.MeshStandardMaterial({ transparent: true, opacity: 0.0 }));
      meshBox3.position.set(4200, -700, 8500);
      meshBox3.name = 'frame1';
      scene.add(meshBox3);

      meshBox4 = new THREE.Mesh(new THREE.BoxBufferGeometry(50, 1500, 740), new THREE.MeshStandardMaterial({transparent: true,opacity:0.0}));
      meshBox4.position.set(-12400, -700, 150);
      meshBox4.name = 'frame2';
      scene.add(meshBox4);
      
      solutionObject1 = new THREE.Mesh(new THREE.BoxBufferGeometry(500, 250, 500), new THREE.MeshStandardMaterial({color: 'white', transparent: true,opacity:1 }));
      solutionObject1.position.set(1000,6000,-5000);
      solutionObject1.name = 'solution1';
      scene.add(solutionObject1);

      solutionObject2 = new THREE.Mesh(new THREE.BoxBufferGeometry(500, 250, 500), new THREE.MeshStandardMaterial({color: 'white', transparent: true,opacity:1 }));
      solutionObject2.position.set(1000,6000,5000);
      solutionObject2.name = 'solution2';
      scene.add(solutionObject2);

      solutionObject3 = new THREE.Mesh(new THREE.BoxBufferGeometry(500, 250, 500), new THREE.MeshStandardMaterial({color: 'white', transparent: true,opacity:1 }));
      solutionObject3.position.set(-8000,6000,-5000);
      solutionObject3.name = 'solution3';
      scene.add(solutionObject3);

      solutionObject4 = new THREE.Mesh(new THREE.BoxBufferGeometry(500, 250, 500), new THREE.MeshStandardMaterial({color: 'white', transparent: true,opacity:1 }));
      solutionObject4.position.set(4000,6000,-5000);
      solutionObject4.name = 'solution4';
      scene.add(solutionObject4);

      solutionObject5 = new THREE.Mesh(new THREE.BoxBufferGeometry(500, 250, 500), new THREE.MeshStandardMaterial({color: 'white', transparent: true,opacity:1 }));
      solutionObject5.position.set(7000,6000,-5000);
      solutionObject5.name = 'solution5';
      scene.add(solutionObject5);

      solutionObject6 = new THREE.Mesh(new THREE.BoxBufferGeometry(500, 250, 500), new THREE.MeshStandardMaterial({color: 'white', transparent: true,opacity:1 }));
      solutionObject6.position.set(10000,6000,-5000);
      solutionObject6.name = 'solution6';
      scene.add(solutionObject6);

      solutionObject7 = new THREE.Mesh(new THREE.BoxBufferGeometry(500, 250, 500), new THREE.MeshStandardMaterial({color: 'white', transparent: true,opacity:1 }));
      solutionObject7.position.set(-2000,6000,-5000);
      solutionObject7.name = 'solution7';
      scene.add(solutionObject7);

      solutionObject8 = new THREE.Mesh(new THREE.BoxBufferGeometry(500, 250, 500), new THREE.MeshStandardMaterial({color: 'white', transparent: true,opacity:1 }));
      solutionObject8.position.set(-5000,6000,-5000);
      solutionObject8.name = 'solution8';
      scene.add(solutionObject8);

      solutionObject9 = new THREE.Mesh(new THREE.BoxBufferGeometry(500, 250, 500), new THREE.MeshStandardMaterial({color: 'white', transparent: true,opacity:1 }));
      solutionObject9.position.set(4000,6000,5000);
      solutionObject9.name = 'solution9';
      scene.add(solutionObject9);

      solutionObject10 = new THREE.Mesh(new THREE.BoxBufferGeometry(500, 250, 500), new THREE.MeshStandardMaterial({color: 'white', transparent: true,opacity:1 }));
      solutionObject10.position.set(7000,6000,5000);
      solutionObject10.name = 'solution10';
      scene.add(solutionObject10);

      solutionObject11 = new THREE.Mesh(new THREE.BoxBufferGeometry(500, 250, 500), new THREE.MeshStandardMaterial({color: 'white', transparent: true,opacity:1 }));
      solutionObject11.position.set(10000,6000,5000);
      solutionObject11.name = 'solution11';
      scene.add(solutionObject11);

      solutionObject12 = new THREE.Mesh(new THREE.BoxBufferGeometry(500, 250, 500), new THREE.MeshStandardMaterial({color: 'white', transparent: true,opacity:1 }));
      solutionObject12.position.set(-2000,6000,5000);
      solutionObject12.name = 'solution12';
      scene.add(solutionObject12);

      solutionObject13 = new THREE.Mesh(new THREE.BoxBufferGeometry(500, 250, 500), new THREE.MeshStandardMaterial({color: 'white', transparent: true,opacity:1 }));
      solutionObject13.position.set(-5000,6000,5000);
      solutionObject13.name = 'solution13';
      scene.add(solutionObject13);

      solutionObject14 = new THREE.Mesh(new THREE.BoxBufferGeometry(500, 250, 500), new THREE.MeshStandardMaterial({color: 'white', transparent: true,opacity:1 }));
      solutionObject14.position.set(-8000,6000,5000)
      solutionObject14.name = 'solution14';
      scene.add(solutionObject14);

      /*solutionObject15 = new THREE.Mesh(new THREE.BoxBufferGeometry(500, 250, 500), new THREE.MeshStandardMaterial({color: 'white', transparent: true,opacity:1 }));
      solutionObject15.position.set(1000,6000,5000);
      solutionObject15.name = 'solution15';
      scene.add(solutionObject15);*/

      meshBox5.callback = function () {
        console.log(this.name);
      }
      meshBox2.callback = function () {
        console.log(this.name);
      }

      //projector
var projector = new THREE.GLTFLoader;
projector.load('models/projector/scene.gltf', function(gltf)
{
   model = gltf.scene;
   console.log(model);
   model.name = 'projector';
   model.scale.set(20,45,12);
   model.position.set(12300,0.5,5200);
   model.rotation.y = 3*(Math.PI/2);
   scene.add(model);
});

//remote
var projector = new THREE.GLTFLoader;
projector.load('models/tv_controller/scene.gltf', function(gltf1)
{
  let model = gltf1.scene;
  console.log(model);
  model.name = 'projector';
  model.scale.set(50,500,50);
  model.position.set(12100,-4500,1000);
  //model.rotation.y = Math.PI/2;
  
  scene.add(model);
});

    }

    /*function abc(event)
    {
      meshBox.scale.set(50,1000,1000);
    }

    meshBox.addEventListener('onclick', abc);
    */
    function animate() {
      renderer.render(scene, camera);
      requestAnimationFrame(animate);
    }

    //new code
    function objectClickHandler() 
    { 
      light.visible = false;
      console.log("ready");

    }

    function objectClickHandler1() {
      light = new THREE.AmbientLight('white',2);
      light.position.set(-1000, -300, -1000);
      scene.add(light);
      meshBox1.material.color.setHex(0x008000);
      requestAnimationFrame(animate);
    }

    function objectCLickHandler2()
    {
      solutionObject1.material.color.setHex(0xff0000);
      solutionObject5.material.color.setHex(0xff0000);
      solutionObject11.material.color.setHex(0xff0000);
      requestAnimationFrame(animate);
      alert('You have recieved a clue');
    }

    function objectCLickHandler3()
    {
      solutionObject3.material.color.setHex(0x008000);
      requestAnimationFrame(animate);
      alert('you have recieved a clue');
    }

    function objectCLickHandler4()
    {
      solutionObject12.material.color.setHex(0x0000ff);
      solutionObject7.material.color.setHex(0x0000ff);
      requestAnimationFrame(animate);
      alert('you have recieved a clue');
    }
// hint


    window.onload = function () {
      init();
      animate();

      var raycaster = new THREE.Raycaster();
      var mouse = new THREE.Vector2();

      // Handle all clicks to determine of a three.js object was clicked and trigger its callback
      function onDocumentMouseDown(event) {
        event.preventDefault();

        mouse.x = (event.clientX / renderer.domElement.clientWidth) * 2 - 1;
        mouse.y = - (event.clientY / renderer.domElement.clientHeight) * 2 + 1;

        raycaster.setFromCamera(mouse, camera);

        meshObjects = [meshBox1,meshBox2,meshBox3,meshBox4,meshBox5]; // three.js objects with click handlers we are interested in

        intersects = raycaster.intersectObjects(meshObjects);
        
        if (intersects.length > 0) {
          //console.log(intersects[0].object.name == 'watch');

          switch(intersects[0].object.name) 
          {         
                    case 'switch1' :
                    {
                      objectClickHandler1();
                      break;
                    }         
                    case 'switch2' :
                    {
                      objectClickHandler();
                      break;           
                    }
                    case 'watch':
                    {
                    objectCLickHandler2();
                    break;              
                    }
                    case 'frame1':
                    {
                      objectCLickHandler3();
                      break;
                    }
                    case 'frame2':
                    {
                      objectCLickHandler4();
                      break;
                    }
          }

         /* switch(intersect[0].object.name)
          {
 case 'switch' :
          if(count == 0)
          {
             objectClickHandler();
            count ++;          
          }
          else{
             alert("not allowed to click");
          }
          break;

          case 'watch' :
          if(count == 1)
          {
             function();
          }
          else
          {
            alert("not allowed to click");
          }
          break;
          case 'frame1' :
          if(count == 2)
          {
             function();
          }
          else
          {
            alert("oops not allowed to click");
          }
          break;
          case 'frame2' :
          if(count == 3)
          {
             function();
          }
          else
          {
            alert("not allowed to click");
          }
          break;
          case 'hint' :
          if(count == 4)
          {
            hintText();
          }
          else
          {
            alert("not allowed to click");
          }
          break;
          default :
          } */
          //intersects[0].object.callback();
        }

      }
      document.addEventListener('mousedown', onDocumentMouseDown, true);
    };

    //window resize
    function onWindowResize(){
		camera.aspect	= window.innerWidth / window.innerHeight;
    renderer.setSize(window.innerWidth, window.innerHeight);
		camera.updateProjectionMatrix();
	}
    window.addEventListener('resize', onWindowResize );

  </script>
</body>

</html>