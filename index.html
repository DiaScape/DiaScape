<html>

<head>
  <meta charset=UTF-8 />
  <link rel="stylesheet" type="text/css" href="style.css" />
</head>

<body>
  <script src="/three.min.js"></script>
  <script src="/orbitControls.js"></script>

  <script>
    let scene, camera, renderer, meshBox;

    function init() {

      scene = new THREE.Scene();
      camera = new THREE.PerspectiveCamera(55, window.innerWidth / window.innerHeight, 45, 30000);
      camera.position.set(-900, -200, -900);

      renderer = new THREE.WebGLRenderer({ antialias: true });
      renderer.setSize(window.innerWidth, window.innerHeight);
      document.body.appendChild(renderer.domElement);

      let controls = new THREE.OrbitControls(camera);
      controls.minDistance = 500;
      controls.maxDistance = 1500;

      let materialArray = [];
      let texture_ft = new THREE.TextureLoader().load('arid2_ft2.jpg');
      let texture_bk = new THREE.TextureLoader().load('arid2_bk2.jpg');
      let texture_up = new THREE.TextureLoader().load('arid2_up2.jpg');
      let texture_dn = new THREE.TextureLoader().load('arid2_dn2.jpg');
      let texture_rt = new THREE.TextureLoader().load('arid2_rt2.jpg');
      let texture_lf = new THREE.TextureLoader().load('arid2_lf2.jpg');

      materialArray.push(new THREE.MeshBasicMaterial({ map: texture_ft }));
      materialArray.push(new THREE.MeshBasicMaterial({ map: texture_bk }));
      materialArray.push(new THREE.MeshBasicMaterial({ map: texture_up }));
      materialArray.push(new THREE.MeshBasicMaterial({ map: texture_dn }));
      materialArray.push(new THREE.MeshBasicMaterial({ map: texture_rt }));
      materialArray.push(new THREE.MeshBasicMaterial({ map: texture_lf }));

      for (let i = 0; i < 6; i++)
        materialArray[i].side = THREE.BackSide;
      let skyboxGeo = new THREE.BoxGeometry(25000, 12000, 17000);
      let skybox = new THREE.Mesh(skyboxGeo, materialArray);
      scene.add(skybox);


      meshBox = new THREE.Mesh(new THREE.BoxBufferGeometry(50, 500, 500), new THREE.MeshBasicMaterial({ transparent: true, opacity: 0.5 }));
      meshBox.position.set(12100, 500, 500);
      meshBox.name = 'watch';
      scene.add(meshBox);

      meshBox.callback = function () {
        console.log(this.name);
      }

    }

    /*function abc(event)
    {
      meshBox.scale.set(50,1000,1000);
    }

    meshBox.addEventListener('onclick', abc);
    */
    function animate() {
      renderer.render(scene, camera);
      requestAnimationFrame(animate);
    }

    //new code
    function objectClickHandler() {
      meshBox.scale.set(50,1000,1000);
    }
    window.onload = function () {
      init();
      animate();

      var raycaster = new THREE.Raycaster();
      var mouse = new THREE.Vector2();

      // Handle all clicks to determine of a three.js object was clicked and trigger its callback
      function onDocumentMouseDown(event) {
        event.preventDefault();

        mouse.x = (event.clientX / renderer.domElement.clientWidth) * 2 - 1;
        mouse.y = - (event.clientY / renderer.domElement.clientHeight) * 2 + 1;

        raycaster.setFromCamera(mouse, camera);

        meshObjects = [meshBox]; // three.js objects with click handlers we are interested in

        var intersects = raycaster.intersectObjects(meshObjects);

        if (intersects.length > 0) {
          console.log(intersects[0].object.name == 'watch');
          if(intersects[0].object.name == 'watch'){
             objectClickHandler();
          }
          intersects[0].object.callback();
        }

      }
      document.addEventListener('mousedown', onDocumentMouseDown, true);
    };
  </script>
</body>

</html>